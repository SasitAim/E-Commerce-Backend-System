<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Login / Register | My Store</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Style ‡πÄ‡∏î‡∏¥‡∏° -->
  <link rel="stylesheet" href="style/style.css">
</head>

<body class="bg-light">

  <!-- Navbar -->
  <div id="navbar-container"></div>

  <main class="container py-5">

    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5">

        <!-- Card -->
        <div class="card card-news shadow-sm border-0">
          <div class="card-body p-4">

            <!-- Title -->
            <h3 class="text-center fw-bold mb-3" id="formTitle">Login</h3>
            <p class="text-center text-muted mb-4" id="formDesc">
              Sign in to continue shopping with us
            </p>

            <!-- Login Form -->
            <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•) -->
            <form id="loginForm">
              <div class="mb-3">
                <label for="userLogin" class="form-label">Username</label>
                <input type="text" id="userLogin" class="form-control" placeholder="Username" required>   
              </div>

              <div class="mb-3">
                <label for="passWLogin" class="form-label">Password</label>
                <input type="password" id="passWLogin" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
              </div>

              <button for type="submit" class="btn btn-dark w-100 mb-3">
                <i class="bi bi-box-arrow-in-right me-1"></i> Login
              </button>
            </form>

            <!-- Register Form -->
            <form id="registerForm" class="d-none">

              <div class="mb-3">
                <label for="userRegister" class="form-label">Username</label>
                <input type="text" id="userRegister" class="form-control" placeholder="Username" required>
              </div>

              <div class="mb-3">
                <label for="passWRegister" class="form-label">Password</label>
                <input type="password" id="passWRegister" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
              </div>

              <div class="mb-3">
                <label for="ConfirmPassW" class="form-label">Confirm Password</label>
                <input type="password" id="ConfirmPassW" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
              </div>

              <button type="submit" class="btn btn-dark w-100 mb-3">
                <i class="bi bi-person-plus me-1"></i> Register
              </button>
            </form>

            <!-- Switch -->
            <div class="text-center">
              <small id="switchText">
                Don't have an account?
                <button type="button" class="btn btn-link fw-bold text-decoration-none p-0 mb-1" onclick="switchForm()"
                  style="font-size: inherit; vertical-align: baseline;">
                  Register
                </button>
              </small>
            </div>


          </div>
        </div>

      </div>
    </div>

  </main>

  <!-- Footer (‡πÉ‡∏ä‡πâ style ‡πÄ‡∏î‡∏¥‡∏°) -->
  <footer class="footer-custom py-5">
    <div class="container">
      <div class="row text-center text-md-start align-items-center">

        <!-- Contact Column -->
        <div class="col-md-6 mb-3 mb-md-0">
          <h6 class="fw-bold">My Store</h6>
          <p class="mb-1">
            My Store thanks all our customers for your trust and support. We're proud to deliver top-quality graphic
            cards for the best gaming experience, and we hope you enjoy the very best from us.
          </p>
        </div>


        <!-- Social Media Column -->
        <div class="col-md-3 mb-3 mb-md-0">
          <h6 class="fw-bold">Product</h6>
          <p class="mb-1"><i class="bi bi-nvidia me-2"></i></i>NVIDIA Geforce RTX series</p>
          <p class="mb-1"><i class="bi bi-amd me-2"></i></i>AMD RADEON</p>
          <p class="mb-1"><i class="bi bi-cpu me-2"></i></i>intel ARC‚Ñ¢</p>
        </div>

        <!-- Contact Column -->
        <div class="col-md-3 mb-3 mb-md-0">
          <h6 class="fw-bold">Contact</h6>
          <p class="mb-1"><i class="bi bi-telephone-fill me-2"></i>089-765-4321</p>
          <p class="mb-1"><i class="bi bi-envelope-fill me-2"></i>My_Store_s@gmail.com</p>
          <p class="mb-1"><i class="bi bi-geo-alt-fill me-2"></i>location</p>
        </div>

      </div>

      <!-- Footer Bottom -->
      <div class="text-center mt-4">
        <div class="social-icons">
          <a href="https://www.facebook.com/" target="_blank" class="me-3"><i class="bi bi-facebook"></i></a>
          <a href="https://twitter.com/" target="_blank" class="me-3"><i class="bi bi-twitter-x"></i></a>
          <a href="https://www.instagram.com/" target="_blank" class="me-3"><i class="bi bi-instagram"></i></a>
          <a href="https://line.me/th/" target="_blank"><i class="bi bi-line"></i></a>
        </div>
        <p class="mb-1">All rights reserved &copy; Aug 2025 My Portfolio My Store</p>
        <p><a href="#" class="text-decoration-none">Back to top</a></p>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Form Toggle -->
  <script>
    function switchForm() {
      const loginForm = document.getElementById("loginForm");
      const registerForm = document.getElementById("registerForm");
      const title = document.getElementById("formTitle");
      const desc = document.getElementById("formDesc");
      const switchText = document.getElementById("switchText");

      if (loginForm.classList.contains("d-none")) { // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ Login ‡∏ñ‡∏π‡∏Å‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏´‡∏° (d-none ‡∏Ñ‡∏∑‡∏≠ ‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà)
        // Switch to Login
        loginForm.classList.remove("d-none"); // ‡∏ñ‡πâ‡∏≤ login ‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏±‡πà‡∏á remove d-none ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ login (‡πÄ‡∏•‡∏¥‡∏ô‡∏ã‡πà‡∏≠‡∏ô)
        registerForm.classList.add("d-none"); // remove d-none ‡∏à‡∏≤‡∏Å login ‡∏°‡∏≤ add ‡πÉ‡∏´‡πâ registerForm ‡πÅ‡∏ó‡∏ô
        title.innerText = "Login";
        desc.innerText = "Sign in to continue shopping with us";
        switchText.innerHTML = `Don‚Äôt have an account?
        <a href="#" class="fw-bold text-decoration-none" onclick="switchForm()">Register</a>`;
      }

      // Switch to Register
      else { // ‡∏´‡∏ô‡πâ‡∏≤ Login ‡πÑ‡∏°‡πà‡∏°‡∏µ d-none (‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ login ‡∏≠‡∏¢‡∏π‡πà)
        loginForm.classList.add("d-none");  // add ‡πÉ‡∏´‡πâ login (‡∏ã‡πà‡∏≠‡∏ô login)
        registerForm.classList.remove("d-none");  // remove d-none ‡∏à‡∏≤‡∏Å register 
        title.innerText = "Register";
        desc.innerText = "Create an account to start shopping";
        switchText.innerHTML = `Already have an account?
        <a href="#" class="fw-bold text-decoration-none" onclick="switchForm()">Login</a>`;
      }
    }
  </script>


  <!-- script login04 -->
  <script>
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      // ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å user ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      const username = document.getElementById('userLogin').value.trim();
      const password = document.getElementById('passWLogin').value.trim();

      if (!username || !password) {
        alert('Please enter username and password');
        return;
      }

      // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏ó‡∏µ‡πà backend
      try {
        const res = await fetch('/api/auth/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, password })  // ‡πÅ‡∏õ‡∏•‡∏á JS object ‚Üí JSON
        });

        const data = await res.json();

        if (!res.ok) {
          alert(data.message || 'Login failed');
          return;
        }

        // ‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å)
        console.log(data.user,data.token);
        
        localStorage.setItem('user', JSON.stringify(data.user));

        // localStorage.setItem('token', JSON.stringify(data.token));
        localStorage.setItem('token', data.token);  // ‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏ä‡πâ‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ


        // ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ home
        globalThis.location.href = '/mystore';

      } catch (err) {
        alert('Cannot connect to server');
        console.error(err);
      }
    });
  </script>



  <!-- script registerForm -->
  <script>
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const username = document.getElementById('userRegister').value.trim();
      const password = document.getElementById('passWRegister').value.trim();
      const confirmPassword = document.getElementById('ConfirmPassW').value.trim();

      // ‡πÑ‡∏°‡πà‡∏¢‡∏¥‡∏á api ‡πÑ‡∏õ‡∏ñ‡πâ‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠ error ‡πÅ‡∏à‡πâ‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏≤‡∏á backend)
      if (!username || !password || !confirmPassword) {
        alert('Please fill all fields');
        return;
      }

      if (password !== confirmPassword) {
        alert('Password and Confirm Password do not match');
        return;
      }

      try {
        const res = await fetch('/api/auth/register', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            username,
            password,
            confirmPassword
          })
        });

        const data = await res.json();

        if (!res.ok) {
          alert(data.message);
          return;
        }

        alert('Register successful üéâ');
        switchForm(); // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login

      } catch (error) {
        alert('Cannot connect to server');
        console.error("Error cannot connect to server", error);
      }
    });
  </script>


  <!-- Navbar Script -->
  <script src="/js/navbar.js"></script>
</body>

</html>

<!-- Note -->
<!-- ‡πÅ‡∏Å‡πâLogin ‡πÉ‡∏´‡πâ‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö backend ‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠ -->